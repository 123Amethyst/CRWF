<core:FragmentDefinition
	xmlns:m="sap.m"
	xmlns:core="sap.ui.core"
  xmlns:tnt="sap.tnt"
  xmlns:l="sap.ui.layout"
  xmlns:u="sap.ui.unified"
  xmlns="sap.ui.table"
  xmlns:html="http://www.w3.org/1999/xhtml"
	>
  <m:Dialog
    class="Padding DialogClass"
		id="dialog_vBAUpload"
    title="{i18n>xfld.FileUpload}"
    contentWidth="600px"
    contentHeight="360px"
   >
    <m:Page
     title="文件上传"
     showHeader="false"
     enableScrolling="false"
     class="sapUiContentPadding">
      <m:content>
        <l:VerticalLayout>
          <l:HorizontalLayout class="sapUiContentPadding">
            <u:FileUploader
              id="fileUploader"
              width="100%"
              sameFilenameAllowed="true"
              class="FileUploaderClass"
              placeholder="{i18n>xfld.PleaseChooseFile}"
             	fileType="xlsx,xls"
              style="Emphasized"
              uploadStart="handleUploadStart"
              change="handleChange">
            </u:FileUploader>
            <m:Link
              class="label"
              text="{i18n>xfld.ClickDownloadTemplate}"
              href="../ui5/template/VBA编号.xlsx"/>
            <m:Button
              text="{i18n>xbut.buttonExcelDataDisplay}"
              press="handleUploadPress"
              class="DefaultButton AutoButton"/>
          </l:HorizontalLayout>
          <l:HorizontalLayout class="sapUiContentPadding">
            <Table
               id="VBATable"
               enableBusyIndicator="true"
               selectionMode="None"
               rows="{dataModel>/VBA}"
               visibleRowCount="5"
               rowActionCount="2"
               enableCellFilter="{ui>/cellFilterOn}"
               ariaLabelledBy="title">
              <columns>
                <Column width="10rem">
                  <m:Label text="{i18n>xfld.UploadResult}" />
                  <template>
                    <m:Text text="{dataModel>Result}" wrapping="false" />
                  </template>
                </Column>
                <Column width="auto">
                  <m:Label text="{i18n>xfld.VBA}" />
                  <template>
                    <m:Text text="{dataModel>VBA}" wrapping="false" />
                  </template>
                </Column>
              </columns>
            </Table>
          </l:HorizontalLayout>
        </l:VerticalLayout>
      </m:content>
    </m:Page>
    <m:buttons>
      <m:Button text="{i18n>xbut.buttonSubmit}" press=".uploadFileData" class="LightButton" type="Emphasized"/>
      <m:Button text="{i18n>xbut.buttonCancel}" press=".onUploadCancel"  class="DarkButton"/>
    </m:buttons>
  </m:Dialog>
</core:FragmentDefinition>